<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architect's Hub | Reputifly</title>
    <link rel="icon" type="image/png" href="https://media.licdn.com/dms/image/v2/D560BAQEScnUkJITXAg/company-logo_200_200/B56ZajOckKHsAI-/0/1746495195792?e=2147483647&v=beta&t=Z7yQpp5jSwm-De46D45WIC5fY_2w0GVgEWLoEOM1aug">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400&family=Playfair+Display:wght@600&family=Roboto+Mono:wght@400&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-deep: #0B0A14;
            --accent-primary: #E6397F;
            --accent-secondary: #FF8A00;
            --text-main: #F0F0F0;
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-bg: rgba(20, 20, 30, 0.6);
        }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        h1, h2, h3, .brand-font { font-family: 'Space Grotesk', sans-serif; letter-spacing: -0.02em; }
        .mono-font { font-family: 'JetBrains Mono', monospace; }

        /* --- BACKGROUND FX --- */
        .mesh-bg {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -2;
            background: 
                radial-gradient(at 0% 0%, hsla(336,83%,56%,0.15) 0px, transparent 50%),
                radial-gradient(at 100% 0%, hsla(28,100%,50%,0.1) 0px, transparent 50%),
                radial-gradient(at 100% 100%, hsla(336,83%,56%,0.1) 0px, transparent 50%),
                radial-gradient(at 0% 100%, hsla(240,100%,70%,0.05) 0px, transparent 50%);
            background-size: 150% 150%;
            animation: fluidBackground 20s ease infinite;
            filter: blur(60px);
        }
        @keyframes fluidBackground { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }

        .noise-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            opacity: 0.04; pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* --- COMPONENTS --- */
        
        /* Glass Panel */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1), border-color 0.3s ease;
        }
        .glass-panel:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Liquid Button */
        .btn-liquid-glow {
            background: radial-gradient(circle at top, rgba(255,255,255,0.4) 0%, transparent 60%),
                        linear-gradient(90deg, #E6397F, #FF8A00);
            box-shadow: 0 10px 30px -10px rgba(230, 57, 127, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.4);
            border: none; position: relative; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-radius: 9999px; color: white; font-weight: 700;
            padding: 10px 24px; font-size: 13px; text-transform: uppercase; letter-spacing: 0.05em;
            display: inline-flex; align-items: center; gap: 8px; cursor: pointer;
        }
        .btn-liquid-glow:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 20px 40px -10px rgba(255, 138, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        /* Hero Glass Button */
        .btn-hero-glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            border-radius: 9999px; color: #ccc; font-weight: 600;
            padding: 8px 16px; font-size: 12px;
            display: inline-flex; align-items: center; gap: 6px; cursor: pointer;
        }
        .btn-hero-glass:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.3);
            color: white;
        }

        /* --- FORM ELEMENTS --- */
        .checkbox-wrapper input:checked + div {
            background: linear-gradient(90deg, #E6397F, #FF8A00);
            border-color: transparent;
            color: white;
            box-shadow: 0 0 15px rgba(230, 57, 127, 0.4);
        }

        .select-card { transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.05); }
        .select-card:hover { background: rgba(255,255,255,0.03); transform: translateY(-2px); }
        
        .select-card.selected { 
            border: 1px solid #E6397F;
            background: rgba(230, 57, 127, 0.05);
            box-shadow: 0 0 20px rgba(230, 57, 127, 0.15);
        }
        
        .check-badge { 
            position: absolute; top: -8px; right: -8px; 
            background: linear-gradient(135deg, #E6397F, #FF8A00); color: white; 
            border-radius: 50%; padding: 4px; display: none; z-index: 10;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .select-card.selected .check-badge { display: block; }

        /* --- LAYOUT --- */
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.3); }

        .nav-item { border-left: 2px solid transparent; transition: all 0.3s; opacity: 0.6; }
        .nav-item:hover { opacity: 1; padding-left: 20px; background: rgba(255,255,255,0.02); }
        .nav-item.active { 
            opacity: 1; 
            border-left-color: #E6397F; 
            background: linear-gradient(90deg, rgba(230,57,127,0.1), transparent);
            color: white;
        }

        .canvas-wrapper { width: 100%; overflow-x: auto; background: white; border-radius: 12px; }
    </style>
</head>
<body>

    <div class="mesh-bg"></div>
    <div class="noise-overlay"></div>

    <div class="flex h-screen overflow-hidden">
        
        <aside class="w-72 border-r border-white/10 flex flex-col pt-8 hidden lg:flex flex-shrink-0 bg-black/20 backdrop-blur-xl">
            <div class="px-8 mb-10">
                <div class="flex items-center gap-3 mb-4">
                    <div class="relative group">
                        <div class="absolute -inset-1 bg-pink-500 rounded-full blur opacity-20 group-hover:opacity-40 transition"></div>
                        <img src="https://media.licdn.com/dms/image/v2/D560BAQEScnUkJITXAg/company-logo_200_200/B56ZajOckKHsAI-/0/1746495195792?e=2147483647&v=beta&t=Z7yQpp5jSwm-De46D45WIC5fY_2w0GVgEWLoEOM1aug" class="relative w-10 h-10 rounded-full border border-white/10" alt="Reputifly">
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-white tracking-tight leading-none">Architect</h1>
                        <p class="text-[10px] text-gray-400 uppercase tracking-widest mt-1">Design System v16.0</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 overflow-y-auto space-y-1 px-4" id="sidebar-nav">
                <a href="#brand-kit" class="nav-item block px-4 py-3 rounded-r-lg text-sm font-medium">1. Brand DNA</a>
                <a href="#page-builder" class="nav-item block px-4 py-3 rounded-r-lg text-sm font-medium">2. Structure Builder</a>
                <a href="#sitemap-gen" class="nav-item block px-4 py-3 rounded-r-lg text-sm font-medium">3. Visual Sitemap</a>
                <a href="#prompt-output" class="nav-item block px-4 py-3 rounded-r-lg text-sm font-medium">4. Get Prompts</a>
            </nav>
        </aside>

        <main class="flex-1 overflow-y-auto relative scroll-smooth" id="main-content">
            <div class="max-w-7xl mx-auto px-6 py-16 space-y-24">

                <section id="brand-kit" class="scroll-mt-10">
                    <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                        <span class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#E6397F] to-[#FF8A00] flex items-center justify-center text-xs shadow-lg">1</span>
                        Brand DNA
                    </h2>

                    <div class="glass-panel p-8 space-y-10">
                        <div>
                            <div class="flex justify-between items-end mb-5">
                                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2">
                                    <i data-feather="droplet" class="w-3 h-3"></i> Color Palette
                                </h3>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="color-grid"></div>
                        </div>

                        <div>
                            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-5 flex items-center gap-2">
                                <i data-feather="type" class="w-3 h-3"></i> Typography
                            </h3>
                            <div class="grid md:grid-cols-3 gap-6" id="font-grid"></div>
                        </div>
                    </div>
                </section>

                <section id="page-builder" class="scroll-mt-10">
                    <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                        <span class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#E6397F] to-[#FF8A00] flex items-center justify-center text-xs shadow-lg">2</span>
                        Structure Builder
                    </h2>

                    <div class="flex border-b border-white/10 mb-8 space-x-2">
                        <button onclick="switchBuildTab('home')" class="px-6 py-3 text-sm font-bold text-white border-b-2 border-[#E6397F] tab-build-btn transition-colors" id="build-tab-home">Home</button>
                        <button onclick="switchBuildTab('about')" class="px-6 py-3 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white tab-build-btn transition-colors" id="build-tab-about">About</button>
                        <button onclick="switchBuildTab('services')" class="px-6 py-3 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white tab-build-btn transition-colors" id="build-tab-services">Services</button>
                        <button onclick="switchBuildTab('contact')" class="px-6 py-3 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white tab-build-btn transition-colors" id="build-tab-contact">Contact</button>
                    </div>

                    <div class="glass-panel p-8 min-h-[500px]">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                            <div class="text-sm text-gray-400 flex items-center gap-2">
                                <i data-feather="info" class="w-4 h-4"></i>
                                Use arrows to reorder. Uncheck to remove.
                            </div>
                            
                            <div class="flex gap-2 w-full md:w-auto">
                                <input type="text" id="custom-section-input" placeholder="e.g., Pricing Calculator" class="bg-black/30 border border-white/10 rounded-full px-5 py-2 text-sm text-white focus:outline-none focus:border-[#E6397F] w-full md:w-64 backdrop-blur-sm">
                                <button onclick="addCustomSection()" class="btn-liquid-glow py-2 px-6 text-xs">
                                    <i data-feather="plus" class="w-3 h-3"></i> Add
                                </button>
                            </div>
                        </div>
                        
                        <div id="builder-list" class="space-y-3 max-w-4xl mx-auto"></div>
                    </div>
                </section>

                <section id="sitemap-gen" class="scroll-mt-10">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                            <span class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#E6397F] to-[#FF8A00] flex items-center justify-center text-xs shadow-lg">3</span>
                            Visual Sitemap
                        </h2>
                        <button onclick="downloadSitemap()" class="btn-hero-glass text-xs">
                            <i data-feather="download" class="w-4 h-4"></i> Download Image
                        </button>
                    </div>

                    <div class="canvas-wrapper p-4 border border-white/10 shadow-2xl">
                        <canvas id="sitemapCanvas" class="block mx-auto"></canvas>
                    </div>
                </section>

                <section id="prompt-output" class="scroll-mt-10 pb-40">
                    <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                        <span class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#E6397F] to-[#FF8A00] flex items-center justify-center text-xs shadow-lg">4</span>
                        Generated Prompts
                    </h2>

                    <div class="glass-panel overflow-hidden">
                        <div class="flex border-b border-white/10 bg-black/20">
                            <button onclick="switchPromptTab('home')" class="flex-1 py-4 text-sm font-bold text-white border-b-2 border-[#E6397F] bg-white/5 prompt-tab-btn transition-all" id="ptab-home">Home</button>
                            <button onclick="switchPromptTab('about')" class="flex-1 py-4 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white hover:bg-white/5 prompt-tab-btn transition-all" id="ptab-about">About</button>
                            <button onclick="switchPromptTab('services')" class="flex-1 py-4 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white hover:bg-white/5 prompt-tab-btn transition-all" id="ptab-services">Services</button>
                            <button onclick="switchPromptTab('contact')" class="flex-1 py-4 text-sm font-medium text-gray-400 border-b-2 border-transparent hover:text-white hover:bg-white/5 prompt-tab-btn transition-all" id="ptab-contact">Contact</button>
                        </div>

                        <div class="p-6 relative group">
                            <button onclick="copyCurrentPrompt()" class="absolute top-6 right-6 btn-liquid-glow text-xs z-10 opacity-80 hover:opacity-100">
                                <i data-feather="copy" class="w-3 h-3"></i> Copy
                            </button>
                            <pre id="prompt-display" class="mono-font text-xs text-gray-300 whitespace-pre-wrap leading-relaxed bg-black/30 p-6 rounded-xl border border-white/5 min-h-[400px]">Loading...</pre>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <script>
        // --- LOGIC ---
        
        // 1. Data Config
        const promptLibrary = {
            'h_hero': `\n**HERO SECTION (High Impact):**\n- **Design:** Full viewport height (min-h-screen). Background: Premium dark overlay (90%) on abstract tech image. \n- **Typography:** H1 Headline massive (text-5xl md:text-7xl), font-weight 800, centered. Subheadline max-width 600px.\n- **Functionality:** Content fade-in upwards. Buttons: Primary (Solid) & Secondary (Glassmorphism).\n`,
            'h_social': `\n**SOCIAL PROOF (Trust Bar):**\n- **Design:** Sleek strip (py-8). Background: Neutral dark gray or white. \n- **Content:** "Trusted by industry leaders" label + Row of 5-6 SVG Logo placeholders.\n- **Style:** Logos grayscale/50% opacity. Hover: Full color/100%.\n`,
            'h_features': `\n**FEATURES GRID (Core Value):**\n- **Design:** 3-Column Grid. Cards: Glassmorphism (dark mode) or Soft Shadow (light mode).\n- **Content:** Large Icon (Brand Color), Bold H3, Description.\n- **Interactivity:** Lift up (-5px) on hover with glow.\n`,
            'h_about': `\n**ABOUT TEASER (Split):**\n- **Layout:** 50/50 Split. Left: High-quality image with rounded corners + "floating" stat card. Right: Text content.\n- **Mobile:** Stack image on top.\n`,
            'h_why': `\n**WHY CHOOSE US:**\n- **Layout:** 2 Columns. Left: Big H2. Right: Vertical list of 4 benefits with Green Checkmark Icons.\n- **Style:** Border-l-4 brand accent on items.\n`,
            'h_testimonials': `\n**TESTIMONIALS SLIDER:**\n- **Design:** Horizontal scroll container. Cards: "Chat Bubble" style.\n- **Content:** 5-Star Rating, Quote, Avatar + Name.\n`,
            'h_faq': `\n**FAQ ACCORDION:**\n- **Design:** Centered max-w-3xl. \n- **Interaction:** Click to expand. Plus icon rotates to Minus.\n`,
            'h_contact_form': `\n**CONTACT FORM SECTION:**\n- **Layout:** Centered or Split. \n- **Fields:** Modern styling (transparent bg, bottom border). Button: Full width with loading state.\n`,
            'h_cta': `\n**FINAL CTA:**\n- **Design:** Bold isolated section. Background: Brand Gradient.\n- **Content:** Centered white text. Big White Button.\n`,
            'hero_small': `\n**PAGE HERO (Compact):**\n- **Design:** Height 40vh. Centered H1 Title + Breadcrumbs.\n`,
            'grid_detailed': `\n**DETAILED GRID:**\n- **Layout:** 2 or 3 columns. Cards with Image, Title, Desc, "Learn More".\n`,
            'split_content': `\n**SPLIT ROW:**\n- **Layout:** Zig-Zag (Text-Image, then Image-Text).\n`,
            'team_grid': `\n**TEAM GRID:**\n- **Design:** 4 Columns. Circular Avatars. Social icons on hover.\n`,
            'contact_split': `\n**CONTACT SPLIT:**\n- **Left:** Info (Phone, Email, Address). \n- **Right:** Form UI (Boxed, Shadow).\n`
        };

        const brandData = {
            colors: [
                { name: 'Trust & Corporate', desc: 'Professional Blue', palette: ['#0f172a', '#1e293b', '#3b82f6', '#60a5fa', '#f8fafc'], hex: '#3b82f6' },
                { name: 'Modern SaaS', desc: 'Vibrant Purple', palette: ['#2e1065', '#581c87', '#7c3aed', '#a78bfa', '#faf5ff'], hex: '#7c3aed' },
                { name: 'Eco & Growth', desc: 'Natural Green', palette: ['#064e3b', '#065f46', '#10b981', '#34d399', '#ecfdf5'], hex: '#10b981' },
                { name: 'High-End Luxury', desc: 'Gold & Black', palette: ['#000000', '#1c1917', '#d97706', '#fbbf24', '#fffbeb'], hex: '#d97706' }
            ],
            fonts: [
                { name: 'Clean Modern', head: 'Inter', body: 'Inter' },
                { name: 'Elegant Serif', head: 'Playfair Display', body: 'Inter' },
                { name: 'Tech Mono', head: 'Roboto Mono', body: 'Inter' }
            ]
        };

        const defaultPages = {
            home: [
                { id: 'h_hero', name: 'Hero Section (Full Screen)' },
                { id: 'h_social', name: 'Social Proof (Logo Strip)' },
                { id: 'h_features', name: 'Features Grid (3-Col)' },
                { id: 'h_about', name: 'About Teaser (Split Layout)' },
                { id: 'h_why', name: 'Why Choose Us (Checklist)' },
                { id: 'h_testimonials', name: 'Testimonials Slider' },
                { id: 'h_faq', name: 'FAQ Accordion' },
                { id: 'h_contact_form', name: 'Contact Form Section' },
                { id: 'h_cta', name: 'Final CTA (Large)' }
            ],
            about: [
                { id: 'hero_small', name: 'Hero (Center Title)' },
                { id: 'split_content', name: 'Mission Statement' },
                { id: 'h_features', name: 'Core Values (4 Cards)' },
                { id: 'team_grid', name: 'Our Team Grid' },
                { id: 'h_cta', name: 'CTA Section' }
            ],
            services: [
                { id: 'hero_small', name: 'Hero Section' },
                { id: 'grid_detailed', name: 'Service List (Detailed)' },
                { id: 'split_content', name: 'Process (How it works)' },
                { id: 'h_faq', name: 'FAQ Section' },
                { id: 'h_cta', name: 'CTA Section' }
            ],
            contact: [
                { id: 'hero_small', name: 'Hero Section' },
                { id: 'contact_split', name: 'Split Layout (Info + Form)' },
                { id: 'h_faq', name: 'FAQ Section' }
            ]
        };

        // State
        let state = { color: 0, font: 0, pages: JSON.parse(JSON.stringify(defaultPages)) };
        Object.keys(state.pages).forEach(key => state.pages[key].forEach((s, i) => { s.checked = true; }));

        let currentTab = 'home';
        let currentPromptTab = 'home';

        // Init
        function init() {
            feather.replace();
            renderBrandKit();
            renderBuilderList();
            updateAllPrompts();
            setTimeout(() => { resizeCanvas(); drawSitemap(); }, 500);
            window.addEventListener('resize', () => { resizeCanvas(); drawSitemap(); });
            
            // ScrollSpy
            const mainContent = document.getElementById('main-content');
            mainContent.addEventListener('scroll', () => {
                const sections = ['brand-kit', 'page-builder', 'sitemap-gen', 'prompt-output'];
                let current = '';
                sections.forEach(id => {
                    const el = document.getElementById(id);
                    if (el.offsetTop - mainContent.scrollTop <= 300) current = id;
                });
                document.querySelectorAll('#sidebar-nav a').forEach(a => {
                    a.classList.remove('active');
                    if(a.getAttribute('href') === '#' + current) a.classList.add('active');
                });
            });
        }

        // Render Functions
        function renderBrandKit() {
            const colorGrid = document.getElementById('color-grid');
            colorGrid.innerHTML = brandData.colors.map((c, i) => `
                <div onclick="selectColor(${i})" class="select-card cursor-pointer p-4 rounded-xl border border-white/5 bg-white/5 ${state.color === i ? 'selected' : ''}">
                    <div class="check-badge"><i data-feather="check" class="w-3 h-3"></i></div>
                    <div class="flex gap-1 h-10 w-full mb-3 rounded-lg overflow-hidden">
                        ${c.palette.map(hex => `<div style="background:${hex}" class="flex-1 h-full"></div>`).join('')}
                    </div>
                    <strong class="text-white text-sm block">${c.name}</strong>
                    <span class="text-xs text-gray-400">${c.desc}</span>
                </div>
            `).join('');

            const fontGrid = document.getElementById('font-grid');
            fontGrid.innerHTML = brandData.fonts.map((f, i) => `
                <div onclick="selectFont(${i})" class="select-card cursor-pointer p-4 rounded-xl border border-white/5 bg-white/5 ${state.font === i ? 'selected' : ''}">
                    <div class="check-badge"><i data-feather="check" class="w-3 h-3"></i></div>
                    <div class="mb-2" style="font-family: '${f.head}'">
                        <span class="text-3xl text-white font-bold">Aa</span>
                    </div>
                    <div class="flex justify-between items-center text-xs text-gray-400">
                        <span>${f.head}</span>
                        <span>+ ${f.body}</span>
                    </div>
                </div>
            `).join('');
            feather.replace();
        }

        function renderBuilderList() {
            const list = document.getElementById('builder-list');
            list.innerHTML = state.pages[currentTab].map((section, index) => `
                <div class="group flex items-center justify-between p-3 rounded-lg border border-white/5 bg-white/5 hover:bg-white/10 transition-colors">
                    <div class="flex items-center gap-4">
                        <label class="checkbox-wrapper cursor-pointer flex items-center">
                            <input type="checkbox" class="hidden" ${section.checked ? 'checked' : ''} onchange="toggleSection(${index})">
                            <div class="w-5 h-5 rounded border border-gray-600 flex items-center justify-center transition-colors">
                                <i data-feather="check" class="w-3 h-3 text-white ${section.checked ? '' : 'opacity-0'}"></i>
                            </div>
                        </label>
                        <span class="text-sm font-medium ${section.checked ? 'text-white' : 'text-gray-500 line-through'} select-none">${section.name}</span>
                    </div>
                    <div class="flex items-center gap-2 opacity-50 group-hover:opacity-100 transition-opacity">
                        <button onclick="moveSection(${index}, -1)" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 rounded"><i data-feather="arrow-up" class="w-4 h-4"></i></button>
                        <button onclick="moveSection(${index}, 1)" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 rounded"><i data-feather="arrow-down" class="w-4 h-4"></i></button>
                        <button onclick="deleteSection(${index})" class="w-8 h-8 flex items-center justify-center text-red-400 hover:bg-red-500/20 rounded ml-2"><i data-feather="x" class="w-4 h-4"></i></button>
                    </div>
                </div>
            `).join('');
            feather.replace();
        }

        // Logic
        function selectColor(i) { state.color = i; renderBrandKit(); updateAllPrompts(); }
        function selectFont(i) { state.font = i; renderBrandKit(); updateAllPrompts(); }
        function switchBuildTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-build-btn').forEach(btn => {
                btn.classList.remove('border-[#E6397F]', 'text-white', 'bg-white/5');
                btn.classList.add('border-transparent', 'text-gray-400');
            });
            document.getElementById(`build-tab-${tab}`).classList.add('border-[#E6397F]', 'text-white', 'bg-white/5');
            document.getElementById(`build-tab-${tab}`).classList.remove('border-transparent', 'text-gray-400');
            renderBuilderList();
        }
        function toggleSection(index) { state.pages[currentTab][index].checked = !state.pages[currentTab][index].checked; renderBuilderList(); drawSitemap(); updateAllPrompts(); }
        function moveSection(index, dir) {
            const list = state.pages[currentTab]; const newIdx = index + dir;
            if(newIdx < 0 || newIdx >= list.length) return;
            [list[index], list[newIdx]] = [list[newIdx], list[index]];
            renderBuilderList(); drawSitemap(); updateAllPrompts();
        }
        function deleteSection(index) { state.pages[currentTab].splice(index, 1); renderBuilderList(); drawSitemap(); updateAllPrompts(); }
        function addCustomSection() {
            const name = document.getElementById('custom-section-input').value.trim();
            if(!name) return;
            state.pages[currentTab].push({ name: name, id: 'grid_detailed', checked: true });
            document.getElementById('custom-section-input').value = '';
            renderBuilderList(); drawSitemap(); updateAllPrompts();
        }
        function switchPromptTab(tab) {
            currentPromptTab = tab;
            document.querySelectorAll('.prompt-tab-btn').forEach(btn => {
                btn.classList.remove('border-[#E6397F]', 'text-white', 'bg-white/5');
                btn.classList.add('border-transparent', 'text-gray-400');
            });
            document.getElementById(`ptab-${tab}`).classList.add('border-[#E6397F]', 'text-white', 'bg-white/5');
            document.getElementById(`ptab-${tab}`).classList.remove('border-transparent', 'text-gray-400');
            updateAllPrompts();
        }

        function updateAllPrompts() {
            const brand = brandData.colors[state.color];
            const font = brandData.fonts[state.font];
            const sections = state.pages[currentPromptTab].filter(s => s.checked);
            let p = `Role: Expert Web Developer.\nTask: Create the ${currentPromptTab.toUpperCase()} Page.\n\n### 1. DESIGN DNA\n- **Primary Color:** ${brand.hex} (${brand.name})\n- **Palette:** [${brand.palette.join(', ')}]\n- **Fonts:** ${font.head} & ${font.body}\n`;
            if(currentPromptTab !== 'home') p += `\n**CONSISTENCY:** Match Home Page screenshot styles exactly.\n`;
            p += `\n### 2. SECTIONS & REQUIREMENTS\n`;
            sections.forEach((s, i) => {
                const detail = promptLibrary[s.id] || `\n**${s.name.toUpperCase()}:**\n- Create a modern, responsive section.\n`;
                p += detail;
            });
            p += `\n### 3. TECH SPECS\n- Tailwind CSS via CDN.\n- Mobile First.\n- SVG Icons.\n- Accessible contrast.`;
            document.getElementById('prompt-display').textContent = p;
        }
        function copyCurrentPrompt() {
            navigator.clipboard.writeText(document.getElementById('prompt-display').textContent).then(() => alert("Copied!"));
        }

        // Sitemap Engine
        function resizeCanvas() {
            const wrapper = document.querySelector('.canvas-wrapper');
            const canvas = document.getElementById('sitemapCanvas');
            canvas.width = wrapper.scrollWidth; // Ensure full width
        }

        function drawSitemap() {
            const canvas = document.getElementById('sitemapCanvas');
            const ctx = canvas.getContext('2d');
            
            const pages = ['home', 'about', 'services', 'contact'];
            const maxSections = Math.max(...pages.map(p => state.pages[p].filter(s=>s.checked).length));
            
            // Fixed Landscape Layout
            canvas.width = 1200; 
            canvas.height = 200 + (maxSections * 60);

            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.textAlign = 'center'; ctx.lineWidth = 2;
            
            const brandColor = brandData.colors[state.color].hex;
            const rootX = 600; const rootY = 40; const pageY = 120;
            const colWidth = 1200 / 4;

            // Root
            drawNode(ctx, 'WEBSITE', rootX, rootY, 140, 40, '#1e293b', '#0f172a', '#fff');

            pages.forEach((page, i) => {
                const x = (colWidth * i) + (colWidth / 2);
                drawOrthogonal(ctx, rootX, rootY + 40, x, pageY);
                drawNode(ctx, page.toUpperCase(), x, pageY, 140, 40, brandColor, brandColor, '#fff');

                const sections = state.pages[page].filter(s => s.checked);
                let currentY = pageY + 60;

                if (sections.length > 0) {
                    ctx.beginPath(); ctx.strokeStyle = '#cbd5e1';
                    ctx.moveTo(x, pageY + 40);
                    ctx.lineTo(x, currentY + ((sections.length-1) * 50));
                    ctx.stroke();

                    sections.forEach(sect => {
                        drawSectionNode(ctx, sect.name, x, currentY);
                        currentY += 50; 
                    });
                }
            });
        }

        function drawNode(ctx, text, x, y, w, h, bg, border, color) {
            ctx.fillStyle = bg; ctx.strokeStyle = border;
            ctx.shadowColor = "rgba(0,0,0,0.15)"; ctx.shadowBlur = 6; ctx.shadowOffsetY = 3;
            ctx.beginPath(); ctx.roundRect(x - w/2, y, w, h, 8); ctx.fill(); ctx.stroke();
            ctx.shadowColor = "transparent"; ctx.fillStyle = color; ctx.font = "bold 13px Inter";
            ctx.fillText(text, x, y + h/2 + 4);
        }

        function drawSectionNode(ctx, text, x, y) {
            ctx.fillStyle = "#ffffff"; ctx.strokeStyle = "#cbd5e1";
            ctx.beginPath(); ctx.roundRect(x - 80, y, 160, 36, 6); ctx.fill(); ctx.stroke();
            ctx.fillStyle = "#475569"; ctx.font = "500 12px Inter";
            const clean = text.split('(')[0].trim();
            ctx.fillText(clean.length > 20 ? clean.substring(0,18)+'...' : clean, x, y + 22);
        }

        function drawOrthogonal(ctx, x1, y1, x2, y2) {
            ctx.strokeStyle = '#94a3b8'; ctx.beginPath();
            ctx.moveTo(x1, y1); ctx.lineTo(x1, (y1+y2)/2);
            ctx.lineTo(x2, (y1+y2)/2); ctx.lineTo(x2, y2); ctx.stroke();
        }

        function downloadSitemap() {
            const canvas = document.getElementById('sitemapCanvas');
            canvas.toBlob(function(blob) { saveAs(blob, "reputifly_sitemap.png"); });
        }

        init();
    </script>
</body>
</html>
