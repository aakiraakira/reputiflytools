<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reputifly API Reference</title>
    <link rel="icon" type="image/png"
        href="https://media.licdn.com/dms/image/v2/D560BAQEScnUkJITXAg/company-logo_200_200/B56ZajOckKHsAI-/0/1746495195792?e=2147483647&v=beta&t=Z7yQpp5jSwm-De46D45WIC5fY_2w0GVgEWLoEOM1aug">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@600;700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --pink: #E6397F;
            --orange: #FF8A00;
            --bg: #060510;
        }

        body {
            background: var(--bg);
            color: #c8c8d0;
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 32px 20px;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--pink), var(--orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card {
            max-width: 520px;
            width: 100%;
            text-align: center;
        }

        .card h1 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 28px;
            color: white;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .card p {
            font-size: 14px;
            color: #666;
            margin-bottom: 36px;
            line-height: 1.6;
        }

        .btn-row {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .dl-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 16px 28px;
            border-radius: 14px;
            border: none;
            cursor: pointer;
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 15px;
            transition: all 0.25s ease;
            text-decoration: none;
        }

        .dl-btn:hover {
            transform: translateY(-3px);
        }

        .dl-json {
            background: linear-gradient(135deg, var(--pink), var(--orange));
            color: white;
            box-shadow: 0 8px 30px -6px rgba(230, 57, 127, 0.4);
        }

        .dl-json:hover {
            box-shadow: 0 14px 40px -6px rgba(230, 57, 127, 0.55);
        }

        .dl-txt {
            background: rgba(255, 255, 255, 0.04);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dl-txt:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .back {
            font-size: 12px;
            color: #444;
            margin-top: 32px;
            text-decoration: none;
            transition: color 0.2s;
        }

        .back:hover {
            color: #888;
        }

        .logo {
            height: 28px;
            filter: brightness(1.2);
            margin-bottom: 24px;
            opacity: 0.7;
        }
    </style>
</head>

<body>
    <div class="card">
        <img src="https://reputifly.com/wp-content/uploads/2025/05/cropped-reputifly-new-e1746390492876.png"
            class="logo" alt="Reputifly">
        <h1>API <span class="gradient-text">Reference</span></h1>
        <p>Download the API reference file and send it to any AI to help you build contact forms, landing pages, or
            integrations.</p>
        <div class="btn-row">
            <button class="dl-btn dl-json" onclick="downloadJSON()">
                <i data-feather="download" style="width:18px;height:18px;"></i> Download JSON
            </button>
            <button class="dl-btn dl-txt" onclick="downloadTXT()">
                <i data-feather="file-text" style="width:18px;height:18px;"></i> Download TXT
            </button>
        </div>
        <a href="index.html" class="back">← Back to App</a>
    </div>

    <script>
        feather.replace();

        const apiRef = {
            name: "Reputifly API",
            version: "6.1",
            description: "Lead capture API built on Firebase Cloud Functions. Receives form submissions via POST, saves them to Firestore, and sends the client an email notification with the lead details.",
            base_url: "https://asia-southeast1-b2b-software.cloudfunctions.net",
            region: "asia-southeast1",
            firebase_project: "b2b-software",
            firebase_config: {
                apiKey: "AIzaSyC9eUHEdAmV9qzHxpQe2en5WeOeRXiq10A",
                authDomain: "b2b-software.firebaseapp.com",
                projectId: "b2b-software",
                storageBucket: "b2b-software.firebasestorage.app",
                messagingSenderId: "231187362713",
                appId: "1:231187362713:web:07f2f24b3c79557f7a9908"
            },
            endpoints: [
                {
                    name: "reputifly",
                    url: "https://asia-southeast1-b2b-software.cloudfunctions.net/reputifly",
                    method: "POST",
                    access: "Public (CORS enabled)",
                    purpose: "Capture a lead from any HTML form. Saves to Firestore and sends email.",
                    content_type: "application/json",
                    reserved_fields: {
                        _to: "Client email address — determines who gets the notification and who owns the lead in the dashboard. Falls back to realjuliantung@gmail.com if omitted.",
                        _subject: "Optional custom email subject. Max 140 chars. Defaults to 'New Lead for {email}'."
                    },
                    dynamic_fields: "Every other field you send becomes lead data. Field names become labels. You can send any fields — name, email, phone, message, company, service, budget, etc. All values are HTML-escaped automatically.",
                    special_behavior: [
                        "If a field named 'email' exists, it's used as the reply-to address in the notification email so the client can reply directly to the lead.",
                        "Metadata (userAgent, IP) is captured automatically from request headers.",
                        "createdAt timestamp is set server-side and cannot be spoofed."
                    ],
                    example_request: {
                        _to: "client@company.com",
                        _subject: "New Website Lead",
                        name: "John Smith",
                        email: "john@example.com",
                        phone: "+1 555 123 4567",
                        message: "I'm interested in your services"
                    },
                    success_response: { success: true, client: "client@company.com" },
                    error_response: { success: false, error: "error message" }
                },
                {
                    name: "createClient",
                    url: "https://asia-southeast1-b2b-software.cloudfunctions.net/createClient",
                    method: "POST",
                    access: "Protected (requires masterKey)",
                    purpose: "Create a new client account with Firebase Auth + Firestore profile.",
                    required_fields: {
                        email: "Client email",
                        password: "Password (min 6 chars)",
                        masterKey: "Admin master key"
                    },
                    success_response: { success: true, uid: "firebase-uid", email: "client@email.com" }
                },
                {
                    name: "manageClient",
                    url: "https://asia-southeast1-b2b-software.cloudfunctions.net/manageClient",
                    method: "POST",
                    access: "Protected (requires masterKey)",
                    purpose: "Disable, enable, or delete a client account.",
                    required_fields: {
                        uid: "Firebase Auth UID of the client",
                        action: "One of: disable, enable, delete",
                        masterKey: "Admin master key"
                    }
                }
            ],
            firestore_schema: {
                leads: {
                    createdAt: "Timestamp (server-set)",
                    status: "'new' | 'contacted' | 'junk'",
                    clientId: "Client email — used to filter leads per client",
                    lead: "Object containing all form fields (dynamic)",
                    metadata: { userAgent: "string", ip: "string" },
                    note: "Optional editable note from portal",
                    contactedAt: "Timestamp — set when status changes to 'contacted'"
                },
                clients: {
                    email: "Client email",
                    createdAt: "Timestamp",
                    status: "'active' | 'disabled'"
                }
            },
            html_form_example: `<form id="contactForm">
  <input type="text" name="name" placeholder="Your Name" required />
  <input type="email" name="email" placeholder="Your Email" required />
  <input type="tel" name="phone" placeholder="Phone" />
  <textarea name="message" placeholder="Message"></textarea>
  <button type="submit">Send</button>
</form>
<script>
document.getElementById('contactForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  data._to = "CLIENT_EMAIL_HERE";
  data._subject = "New Contact Form Lead";
  const res = await fetch("https://asia-southeast1-b2b-software.cloudfunctions.net/reputifly", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });
  const result = await res.json();
  if (result.success) { alert("Sent!"); e.target.reset(); }
});
<\/script>`
        };

        function downloadJSON() {
            const blob = new Blob([JSON.stringify(apiRef, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'reputifly-api-reference.json';
            a.click();
            URL.revokeObjectURL(a.href);
        }

        function downloadTXT() {
            let txt = `REPUTIFLY API REFERENCE\n`;
            txt += `=======================\n\n`;
            txt += `${apiRef.description}\n\n`;
            txt += `Base URL: ${apiRef.base_url}\n`;
            txt += `Region: ${apiRef.region}\n`;
            txt += `Firebase Project: ${apiRef.firebase_project}\n\n`;

            txt += `FIREBASE CONFIG (for frontend apps):\n`;
            txt += JSON.stringify(apiRef.firebase_config, null, 2) + `\n\n`;

            txt += `---\n\n`;

            apiRef.endpoints.forEach(ep => {
                txt += `ENDPOINT: ${ep.name}\n`;
                txt += `URL: ${ep.url}\n`;
                txt += `Method: ${ep.method}\n`;
                txt += `Access: ${ep.access}\n`;
                txt += `Purpose: ${ep.purpose}\n`;
                if (ep.content_type) txt += `Content-Type: ${ep.content_type}\n`;
                if (ep.reserved_fields) {
                    txt += `\nReserved Fields:\n`;
                    Object.entries(ep.reserved_fields).forEach(([k, v]) => { txt += `  ${k}: ${v}\n`; });
                }
                if (ep.dynamic_fields) txt += `\nDynamic Fields: ${ep.dynamic_fields}\n`;
                if (ep.special_behavior) {
                    txt += `\nSpecial Behavior:\n`;
                    ep.special_behavior.forEach(s => { txt += `  - ${s}\n`; });
                }
                if (ep.required_fields) {
                    txt += `\nRequired Fields:\n`;
                    Object.entries(ep.required_fields).forEach(([k, v]) => { txt += `  ${k}: ${v}\n`; });
                }
                if (ep.example_request) {
                    txt += `\nExample Request:\n${JSON.stringify(ep.example_request, null, 2)}\n`;
                }
                if (ep.success_response) {
                    txt += `\nSuccess Response:\n${JSON.stringify(ep.success_response, null, 2)}\n`;
                }
                txt += `\n---\n\n`;
            });

            txt += `FIRESTORE SCHEMA:\n\n`;
            txt += `Collection "leads":\n${JSON.stringify(apiRef.firestore_schema.leads, null, 2)}\n\n`;
            txt += `Collection "clients":\n${JSON.stringify(apiRef.firestore_schema.clients, null, 2)}\n\n`;

            txt += `---\n\n`;
            txt += `HTML FORM EXAMPLE:\n\n${apiRef.html_form_example}\n`;

            const blob = new Blob([txt], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'reputifly-api-reference.txt';
            a.click();
            URL.revokeObjectURL(a.href);
        }
    </script>
</body>

</html>
